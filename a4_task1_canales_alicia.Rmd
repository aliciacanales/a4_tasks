---
title: "Assignment 4 Task 1"
author: "Alicia Canales"
date: "2023-03-14"
output: 
  html_document:
    code_folding: 'hide'
---

```{r setup, include=TRUE, message=FALSE, warning=FALSE}
knitr::opts_chunk$set(echo = TRUE, message=FALSE, warning=FALSE)
```

```{r}
library(tidyverse)
library(here)
library(sf)
library(tmap)
library(terra)
library(gstat)
library(stars)
library(ggplot2)
```

#### Make an exploratory interactive map in tmap showing the location of oil spill events included in the data. Make a finalized static choropleth map in ggplot in which the fill color for each county depends on the count of inland oil spill events by county for the 2008 oil spill data

*Reading in data and converting shape files*
```{r}
# reading in the data
oil_spill <- read_csv(here('data', 'Oil_Spill_Incident_Tracking_[ds394].csv'))

# reading in ca_counties shape file
ca_counties_sf <- read_sf(here('data', 'ca_counties', 'CA_Counties_TIGER2016.shp')) %>% 
  janitor::clean_names() %>%
  dplyr::select(county_name = name, land_area = aland)

# st_crs(ca_counties_sf) projection WGS 84; EPSG 3857

# setting the CRS to match each other
oil_sf <- st_as_sf(oil_spill, coords = c("LATITUDE","LONGITUDE"), 
           crs = st_crs(ca_counties_sf)) %>% 
  janitor::clean_names()

```

*Making tmap*
```{r}
# tmap is good i think
tmap_mode(mode = "view")

tm_shape(oil_sf) +
  tm_dots('localecity', palette = 'Blues')
```

Make a finalized static choropleth map in ggplot in which the fill color for each county depends on the count of inland oil spill events by county for the 2008 oil spill data

```{r}

# creating new subset that will show total amount of oil events in each county 
ca_combine_sf <- ca_counties_sf %>% 
  st_join(oil_sf)

county_oil_sf <- combine_sf %>% 
  group_by(LOCALECOUN) %>% 
  summarize('Total Count' = sum(!is.na(LOCALECOUN)))

# choroplerth, can't figure this out ???
ggplot(data = combine_sf) +
  geom_sf(aes(fill = land_area), color = "white", size = 0.1) +
  scale_fill_gradientn(colors = c("lightgray","orange","red")) +
  theme_minimal() +
  labs(fill = "Number of S. punicea records")

```




